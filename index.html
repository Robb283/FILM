<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Scegli un Film</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f9f9f9;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2em;
    }

    h1 {
      color: #333;
      font-size: 2em;
    }

    button {
      font-size: 1.2em;
      padding: 10px 20px;
      margin: 1em 0;
      cursor: pointer;
    }

    #film-info {
      text-align: center;
      max-width: 600px;
    }

    #film-title {
      font-size: 1.5em;
      font-weight: bold;
      margin-top: 0.5em;
    }

    #film-year {
      font-size: 1.1em;
      color: #666;
      margin-bottom: 0.5em;
    }

    #film-overview {
      font-size: 1em;
      margin: 1em 0;
      color: #444;
    }

    #poster {
      max-width: 300px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
      margin: 1em auto;
    }

    #error {
      color: red;
      margin-top: 15px;
    }
  </style>
</head>
<body>

  <h1>ðŸŽ¬ Scegli un Film Casuale</h1>
  <button onclick="scegliFilm()">Scegli Film</button>

  <div id="film-info">
    <div id="film-title"></div>
    <div id="film-year"></div>
    <img id="poster" src="" alt="" style="display:none">
    <div id="film-overview"></div>
    <div id="error"></div>
  </div>

  <script>
    let filmList = [];

    // Carica la lista dei film
    fetch('film_list.json')
      .then(response => response.json())
      .then(data => {
        filmList = data;
      })
      .catch(() => {
        document.getElementById("error").innerText = "Errore nel caricamento della lista.";
      });

    function scegliFilm() {
      if (filmList.length === 0) {
        document.getElementById("error").innerText = "La lista Ã¨ vuota o non Ã¨ stata caricata.";
        return;
      }

      const titolo = filmList[Math.floor(Math.random() * filmList.length)];
      cercaFilm(titolo);
    }

    function cercaFilm(titolo) {
      const apiKey = '772f6594d69dd39cb6cf2fe95b46b8ce';
      const url = `https://api.themoviedb.org/3/search/movie?api_key=${apiKey}&query=${encodeURIComponent(titolo)}&language=it-IT`;

      fetch(url)
        .then(response => response.json())
        .then(data => {
          if (data.results && data.results.length > 0) {
            const film = data.results[0];
            document.getElementById("film-title").innerText = film.title || titolo;
            document.getElementById("film-year").innerText = film.release_date ? `Anno: ${film.release_date.substring(0, 4)}` : '';
            document.getElementById("film-overview").innerText = film.overview || 'Trama non disponibile.';

            if (film.poster_path) {
              const posterUrl = `https://image.tmdb.org/t/p/w500${film.poster_path}`;
              const poster = document.getElementById("poster");
              poster.src = posterUrl;
              poster.alt = film.title;
              poster.style.display = "block";
            } else {
              document.getElementById("poster").style.display = "none";
            }

            document.getElementById("error").innerText = "";
          } else {
            mostraErrore("Film non trovato.");
          }
        })
        .catch(() => {
          mostraErrore("Errore nella ricerca del film.");
        });
    }

    function mostraErrore(msg) {
      document.getElementById("film-title").innerText = "";
      document.getElementById("film-year").innerText = "";
      document.getElementById("film-overview").innerText = "";
      document.getElementById("poster").style.display = "none";
      document.getElementById("error").innerText = msg;
    }
  </script>

</body>
</html>
